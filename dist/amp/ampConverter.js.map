{"version":3,"sources":["../../src/amp/ampConverter.js"],"names":["cheerio","AMP","content","documents","$","loadDocument","documentFlag","find","each","img","stringSRC","String","attr","width","height","layout","Content","html","ampIMG","replaceWith","index","element","iframe","attribs","ampiframe","title","id","src","css","ampStyle","facebookAppId","ampSocialShare","remove","removeAttr","children","module","exports"],"mappings":"AAAA;;;;AACA;;IAAYA,O;;AACZ;;;;;;IACMC,G;AACF,iBAAYC,OAAZ,EAAoB;AAAA;;AAChB,aAAKA,OAAL,GAAeA,OAAf;AACH;;;;gCACOA,O,EAAQ;AACZ,gBAAMC,YAAY,wBAAlB;AACA,gBAAIC,IAAID,UAAUE,YAAV,CAAuBH,OAAvB,CAAR;AACA,mBAAOE,CAAP;AACH;;;iCACKA,C,EAAEE,Y,EAAa;AACjB;;;;AAKAF,cAAE,MAAF,EAAUG,IAAV,CAAe,KAAf,EAAsBC,IAAtB,CAA2B,YAAU;AACjC,oBAAIC,MAAM;AACNC,+BAAUC,OAAOP,EAAE,IAAF,EAAQQ,IAAR,CAAa,KAAb,CAAP,CADJ;AAENC,2BAAO,EAFD;AAGNC,4BAAQ,CAHF;AAINC,4BAAO,YAJD;AAKNC,6BAAQZ,EAAE,IAAF,EAAQa,IAAR;AALF,iBAAV;AAOA,oBAAIC,6BAA2BT,IAAIC,SAA/B,kBAAqDD,IAAII,KAAzD,mBAA4EJ,IAAIK,MAAhF,iBAAkGL,IAAIM,MAAtG,WAAkHN,IAAIO,OAAtH,gBAAJ;AACAZ,kBAAE,IAAF,EAAQe,WAAR,CAAoBD,MAApB;AACH,aAVD;AAWC;;;;AAKDd,cAAE,QAAF,EAAYI,IAAZ,CAAiB,UAASY,KAAT,EAAgBC,OAAhB,EAAyB;AACtC,oBAAIC,SAASD,QAAQE,OAArB;AACA,oBAAIC,uHAAqHF,OAAOG,KAA5H,YAAwIH,OAAOI,EAA/I,aAAyJJ,OAAOK,GAAhK,mBAAJ;AACAvB,kBAAE,IAAF,EAAQe,WAAR,CAAoBK,SAApB;AACH,aAJD;AAKC;;;;AAKDpB,cAAE,8BAAF,EAAkCI,IAAlC,CAAuC,YAAU;AACzC,oBAAIoB,MAAMxB,EAAE,IAAF,EAAQa,IAAR,EAAV;AACA,oBAAIY,kCAAgCD,GAAhC,aAAJ;AACAxB,kBAAE,IAAF,EAAQe,WAAR,CAAoBU,QAApB;AACP,aAJD;AAKC;;;;AAKDzB,cAAE,gBAAF,EAAoBI,IAApB,CAAyB,YAAU;AAC/B,oBAAIsB,gBAAgB1B,EAAE,eAAF,EAAmBQ,IAAnB,CAAwB,QAAxB,CAApB;AACA,oBAAImB,qKACoGD,aADpG,0RAAJ;AAKA1B,kBAAE,IAAF,EAAQe,WAAR,CAAoBY,cAApB;AACH,aARD;;AAUA,gBAAGzB,YAAH,EAAgB;AACZ,uBAAOF,EAAE,MAAF,EAAUa,IAAV,EAAP;AACH,aAFD,MAII;AACA,uBAAOb,EAAE,MAAF,EAAUa,IAAV,EAAP;AACH;AACJ;;;oCACWb,C,EAAE;AACT;;;;AAKDA,cAAE,8BAAF,EAAkCI,IAAlC,CAAuC,YAAU;AAC7CJ,kBAAE,IAAF,EAAQ4B,MAAR;AACH,aAFD;AAGA5B,cAAE,qCAAF,EAAyCI,IAAzC,CAA8C,YAAU;AACpDJ,kBAAE,IAAF,EAAQ4B,MAAR;AACH,aAFD;AAGA5B,cAAE,gCAAF,EAAoCI,IAApC,CAAyC,YAAU;AAC/CJ,kBAAE,IAAF,EAAQ4B,MAAR;AACH,aAFD;AAGC;;;;AAKD5B,cAAE,wBAAF,EAA4BI,IAA5B,CAAiC,YAAU;AACvCJ,kBAAE,IAAF,EAAQ4B,MAAR;AACH,aAFD;AAGA;;;AAKA5B,cAAE,GAAF,EAAOI,IAAP,CAAY,YAAW;AACnBJ,kBAAE,IAAF,EAAQ6B,UAAR,CAAmB,OAAnB;AACH,aAFD;AAGA7B,cAAE,MAAF,EAAUI,IAAV,CAAe,YAAW;AACtBJ,kBAAE,IAAF,EAAQ6B,UAAR,CAAmB,OAAnB;AACH,aAFD;AAGA7B,cAAE,OAAF,EAAWI,IAAX,CAAgB,YAAW;AACvBJ,kBAAE,IAAF,EAAQ6B,UAAR,CAAmB,OAAnB;AACH,aAFD;AAGA7B,cAAE,IAAF,EAAQI,IAAR,CAAa,YAAW;AACpBJ,kBAAE,IAAF,EAAQ6B,UAAR,CAAmB,OAAnB;AACH,aAFD;AAGA7B,cAAE,IAAF,EAAQI,IAAR,CAAa,YAAW;AACpBJ,kBAAE,IAAF,EAAQ6B,UAAR,CAAmB,OAAnB;AACH,aAFD;AAGA7B,cAAE,IAAF,EAAQI,IAAR,CAAa,YAAW;AACpBJ,kBAAE,IAAF,EAAQ6B,UAAR,CAAmB,OAAnB;AACH,aAFD;AAGA7B,cAAE,IAAF,EAAQI,IAAR,CAAa,YAAW;AACpBJ,kBAAE,IAAF,EAAQ6B,UAAR,CAAmB,OAAnB;AACH,aAFD;AAGA7B,cAAE,SAAF,EAAaI,IAAb,CAAkB,YAAW;AACzBJ,kBAAE,IAAF,EAAQ6B,UAAR,CAAmB,OAAnB;AACH,aAFD;AAGA7B,cAAE,QAAF,EAAYI,IAAZ,CAAiB,YAAU;AACvBJ,kBAAE,IAAF,EAAQ6B,UAAR,CAAmB,OAAnB;AACH,aAFD;;AAIC;;;;AAKD7B,cAAE,MAAF,EAAU8B,QAAV,CAAmB,OAAnB,EAA4B1B,IAA5B,CAAiC,YAAU;AACvCJ,kBAAE,IAAF,EAAQ4B,MAAR;AACH,aAFD;AAGA5B,cAAE,MAAF,EAAUI,IAAV,CAAe,YAAU;AACrBJ,kBAAE,IAAF,EAAQ4B,MAAR;AACH,aAFD;AAGH;;;;;;AAELG,OAAOC,OAAP,GAAiB,EAACnC,QAAD,EAAjB","file":"ampConverter.js","sourcesContent":["'use strict';\nimport * as cheerio from 'cheerio';\nimport {HTML,Head} from '../html/htmlDocument';\nclass AMP {\n    constructor(content){\n        this.content = content;\n    }\n    getHTML(content){\n        const documents = new HTML();\n        let $ = documents.loadDocument(content);\n        return $;\n    }\n quickFix($,documentFlag){\n        /* \n       \n            Change all images into amp images\n            \n        */\n        $('body').find('img').each(function(){\n            let img = {\n                stringSRC:String($(this).attr('src')), \n                width: 16, \n                height: 9, \n                layout:\"responsive\",\n                Content:$(this).html()\n            };\n            let ampIMG = `<amp-img src = ${img.stringSRC}  width = ${img.width}  height = ${img.height} layout= ${img.layout}>  ${img.Content} </amp-img>`;\n            $(this).replaceWith(ampIMG);\n        });\n         /* \n       \n            change iframe into amp iframes\n            \n        */\n        $('iframe').each(function(index, element) {\n            let iframe = element.attribs;\n            let ampiframe = `<amp-iframe width=\"16\" height=\"9\" sandbox=\"allow-scripts allow-same-origin\" layout=\"responsive\" title=${iframe.title} id=${iframe.id} src=${iframe.src}></amp-iframe>`;\n            $(this).replaceWith(ampiframe);\n        });\n         /* \n       \n            change style tags into amp style tags \n            \n        */\n        $('style:not([amp-boilerplate])').each(function(){\n                let css = $(this).html();\n                let ampStyle = `<style amp-custom>${css}</style>`\n                $(this).replaceWith(ampStyle);\n        });\n         /* \n       \n            Change any share buttons into amp social share buttons\n            \n        */\n        $('#socialButtons').each(function(){\n            let facebookAppId = $('#facebookLink').attr('app_id');\n            let ampSocialShare = `<div id=\"ampSocialButtons\">\n                <amp-social-share id=\"ampFacebookLink\"  width=\"30\" height=\"30\"  type=\"facebook\" data-param-app_id=${facebookAppId}></amp-social-share>\n                <amp-social-share id=\"ampTwitterLink\"  width=\"30\" height=\"30\"   type=\"twitter\"></amp-social-share>\n                <amp-social-share id=\"ampLinkedinLink\"  width=\"30\" height=\"30\"  type=\"linkedin\"></amp-social-share>\n                </div>`;\n            $(this).replaceWith(ampSocialShare);\n        });\n\n        if(documentFlag){\n            return $('body').html();\n        }\n\n        else{\n            return $('html').html();\n        }       \n    }\n    quickDelete($){\n         /* \n       \n            remove unsupported scripts\n            \n        */\n        $('script[type=\"text/template\"]').each(function(){\n            $(this).remove(); \n        });\n        $('script[type=\"application/template\"]').each(function(){\n            $(this).remove();\n        });\n        $('script[type=\"text/javascript\"]').each(function(){\n            $(this).remove();\n        });\n         /* \n       \n            remove external stylesheets\n            \n        */\n        $('link[rel=\"stylesheet\"]').each(function(){\n            $(this).remove();\n        });\n        /* \n       \n            remove inline CSS\n\n        */\n        $('p').each(function() {\n            $(this).removeAttr('style');\n        });\n        $('span').each(function() {\n            $(this).removeAttr('style');\n        });\n        $('table').each(function() {\n            $(this).removeAttr('style');\n        });\n        $('td').each(function() {\n            $(this).removeAttr('style');\n        });\n        $('tr').each(function() {\n            $(this).removeAttr('style');\n        });\n        $('th').each(function() {\n            $(this).removeAttr('style');\n        });\n        $('em').each(function() {\n            $(this).removeAttr('style');\n        });\n        $('section').each(function() {\n            $(this).removeAttr('style');\n        });\n        $('strong').each(function(){\n            $(this).removeAttr('style');\n        })\n\n         /* \n       \n            remove CSS not in Head\n            \n        */\n        $('body').children('style').each(function(){\n            $(this).remove();\n        });\n        $('font').each(function(){\n            $(this).remove();\n        });   \n    }\n}\nmodule.exports = {AMP};"]}